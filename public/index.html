<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>OSC → Web</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 20px; }
    #log { white-space: pre; font-family: ui-monospace, monospace; }
  </style>
</head>
<body>
  <h1>OSC → WebSocket</h1>
  <div id="status">Connessione…</div>
  <div id="log"></div>

  <script>
    const host = location.hostname || "raspberrypi.local";
    const ws = new WebSocket(`ws://${host}:8081`);
    const status = document.getElementById("status");
    const log = document.getElementById("log");

    ws.onopen = () => status.textContent = "Connesso";
    ws.onclose = () => status.textContent = "Disconnesso";
    ws.onerror = () => status.textContent = "Errore WS";

    ws.onmessage = (evt) => {
      try {
        const msg = JSON.parse(evt.data);
        log.textContent =
          `[${new Date().toLocaleTimeString()}] ${msg.address} ${JSON.stringify(msg.args)}\n` +
          log.textContent;
        // TODO: aggiorna UI in base agli indirizzi (es. /slider1, /toggleA, ecc.)
      } catch {}
    };
  </script>
</body>
</html>
